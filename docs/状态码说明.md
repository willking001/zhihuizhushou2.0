# 电小助2.0 状态码说明文档

## 概述

本文档说明了电小助2.0系统中使用的状态码体系，包括HTTP状态码和业务状态码。系统采用了统一的状态码管理方式，前后端分别通过常量文件/类来维护这些状态码，确保一致性。

## 状态码分类

系统中的状态码分为两类：

1. **HTTP状态码**：标准的HTTP协议状态码，用于表示请求的处理结果
2. **业务状态码**：系统自定义的业务状态码，用于表示具体的业务处理结果

- 1.
启动后端服务（Spring Boot应用）在8082端口
- 2.
启动前端服务（Vite开发服务器）在5173端口
- 3.
前端服务通过代理配置将所有 `/user` 开头的请求转发到后端服务的 `/api` 路径
- 4.
后端服务通过 `@RestController` 注解将所有 `/api` 开头的请求映射到对应的控制器方法
- 5.
控制器方法通过 `@RequestMapping` 注解指定具体的请求路径和HTTP方法
- 6.
控制器方法根据业务逻辑处理请求，返回相应的业务状态码和数据
- 7.
前端服务通过 `@RestController` 注解将所有 `/api` 开头的请求映射到对应的控制器方法
- 8.
控制器方法通过 `@RequestMapping` 注解指定具体的请求路径和HTTP方法
- 9.
控制器方法根据业务逻辑处理请求，返回相应的业务状态码和数据

## HTTP状态码

| 状态码 | 说明 |
|-------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 未认证 |
| 403 | 权限不足 |
| 404 | 资源不存在 |
| 429 | 请求频率限制 |
| 500 | 服务器内部错误 |

## 业务状态码

| 状态码 | 说明 |
|-------|------|
| 20000 | 操作成功 |
| 50000 | 操作失败 |
| 50001 | 用户名或密码错误 |
| 50014 | Token过期 |

## 前端状态码使用

前端通过 `src/constants/statusCode.ts` 文件定义和使用状态码：

```typescript
// 引入状态码常量
import { BUSINESS_CODE, isSuccessCode, isReLoginCode } from '@/constants/statusCode'

// 判断是否成功状态码
if (isSuccessCode(response.code)) {
  // 处理成功响应
}

// 判断是否需要重新登录
if (isReLoginCode(response.code)) {
  // 处理登录过期情况
}
```

## 后端状态码使用

后端通过 `com.dianxiaozhu.backend.constants.StatusCode` 类定义和使用状态码：

```java
// 引入状态码常量类
import com.dianxiaozhu.backend.constants.StatusCode;

// 使用HTTP状态码
int httpOk = StatusCode.Http.OK;

// 使用业务状态码
int businessSuccess = StatusCode.Business.SUCCESS;

// 创建成功响应
ApiResponse.success(data);

// 创建错误响应
ApiResponse.error(StatusCode.Business.LOGIN_ERROR, "用户名或密码错误");
```

## 响应格式

### 成功响应

```json
{
  "code": 20000,
  "message": "success",
  "data": {}
}
```

### 错误响应

```json
{
  "code": 50001,
  "message": "用户名或密码错误",
  "data": null
}
```

## 注意事项

1. 前后端交互时，应始终使用业务状态码而非HTTP状态码来判断业务处理结果
2. HTTP状态码主要用于网络层面的状态判断
3. 新增状态码时，应同时更新前后端的状态码常量文件/类
4. 状态码的修改应谨慎，并确保前后端同步更新